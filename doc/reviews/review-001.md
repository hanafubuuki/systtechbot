# –û—Ç—á–µ—Ç –æ —Ä–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–∞ #001

**–î–∞—Ç–∞:** 2025-10-11
**–ê–≤—Ç–æ—Ä:** AI Code Reviewer

---

## –†–µ–∑—é–º–µ

–ü—Ä–æ–µ–∫—Ç **systtechbot** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π MVP Telegram-–±–æ—Ç–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π LLM. –ü—Ä–æ–µ–∫—Ç –ø—Ä–æ—à–µ–ª –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (8 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ + 5 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞) –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** ‚úÖ **–û—Ç–ª–∏—á–Ω–æ** (90/100)

---

## –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

### –£—Ä–æ–≤–µ–Ω—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

**–û—Ü–µ–Ω–∫–∞: –û—Ç–ª–∏—á–Ω–æ** (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞ 90%)

### –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

1. ‚úÖ **100% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî –≤—Å–µ 8 –∏—Ç–µ—Ä–∞—Ü–∏–π MVP –∑–∞–≤–µ—Ä—à–µ–Ω—ã
2. ‚úÖ **100% —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥** ‚Äî –≤—Å–µ 5 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
3. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞** ‚Äî –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã ruff, mypy, pytest-cov
4. ‚úÖ **–í—ã—Å–æ–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** ‚Äî 94% coverage (—Ü–µ–ª—å: 80%+)
5. ‚úÖ **–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è** ‚Äî 0 –æ—à–∏–±–æ–∫ mypy —Å `disallow_untyped_defs`
6. ‚úÖ **–ß–∏—Å—Ç—ã–π –∫–æ–¥** ‚Äî 0 –æ—à–∏–±–æ–∫ ruff check
7. ‚úÖ **66 –∑–µ–ª–µ–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** ‚Äî –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
8. ‚úÖ **TDD –ø–æ–¥—Ö–æ–¥** ‚Äî –∏—Ç–µ—Ä–∞—Ü–∏—è 8 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ RED-GREEN-REFACTOR
9. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞ –∏ –ø–æ–ª–Ω–∞ (vision.md, tasklists, ADRs, README)
10. ‚úÖ **–°–æ–±–ª—é–¥–µ–Ω–∏–µ KISS** ‚Äî –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –º–∏–Ω–∏–º–∞–ª–∏–∑–º –≤–æ –≤—Å–µ–º

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **–¢—Ä–µ—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å–æ–±–ª—é–¥–µ–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–æ:
  - `handlers/` ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏–µ–º/–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
  - `services/` ‚Äî –≤—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
  - `roles/` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–æ–º–ø—Ç—ã)

- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**:
  - `bot.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
  - `config.py` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  - `constants.py` ‚Äî enums –≤–º–µ—Å—Ç–æ magic strings
  - `message_types.py` ‚Äî TypedDict –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö

- **In-memory —Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ø—Ä–æ—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å `user_contexts` –±–µ–∑ overengineering

- **Singleton pattern** –¥–ª—è OpenAI –∫–ª–∏–µ–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Å—Ç–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ

#### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `__init__.py` —Ñ–∞–π–ª–æ–≤ —Å —ç–∫—Å–ø–æ—Ä—Ç–∞–º–∏**: –°–µ–π—á–∞—Å `__init__.py` –ø—É—Å—Ç—ã–µ, —á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å —É–¥–æ–±–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã:
  ```python
  # handlers/__init__.py
  from . import commands, messages
  __all__ = ["commands", "messages"]
  ```
  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è MVP)

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –ü—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—è DTO (Data Transfer Objects) –º–µ–∂–¥—É handlers –∏ services –¥–ª—è —è–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–∞–Ω–Ω—ã—Ö
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ `doc/adrs/` (—É–∂–µ –µ—Å—Ç—å ADR-01, ADR-02 ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞!)

---

### 2. –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á–µ—Ä–µ–∑ `ruff format`, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ –ø–æ –≤—Å–µ–º—É –ø—Ä–æ–µ–∫—Ç—É
- **–õ–∏–Ω—Ç–∏–Ω–≥**: 0 –æ—à–∏–±–æ–∫ `ruff check` (E, W, F, I, B, C4, UP –ø—Ä–∞–≤–∏–ª–∞)
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: 0 –æ—à–∏–±–æ–∫ `mypy` –≤ strict mode —Å `disallow_untyped_defs`
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Python 3.11+ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**:
  - `str | None` –≤–º–µ—Å—Ç–æ `Optional[str]`
  - `list[dict]` –≤–º–µ—Å—Ç–æ `List[Dict]`
  - `dataclass` –¥–ª—è `Config`
  - `Enum` –¥–ª—è `MessageRole`

- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: Comprehensive exception handling –≤ `services/llm.py`:
  - `RateLimitError`
  - `APITimeoutError`
  - `APIConnectionError`
  - `APIStatusError` —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–¥–æ–≤
  - Fallback –Ω–∞ generic `Exception`

- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (`user_id`, `chat_id`, –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π)

- **Guard clauses**: –í–µ–∑–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `if not message.from_user: return`

- **–ù–µ—Ç magic strings/numbers**: –í—Å–µ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö –∏–ª–∏ enums

- **Docstrings**: Google style –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

#### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ docstrings –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö**: –ù–∞–ø—Ä–∏–º–µ—Ä, `_get_or_create_client()` –∏–º–µ–µ—Ç docstring (—Ö–æ—Ä–æ—à–æ), –Ω–æ –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **Markdown cleanup –≤ `llm.py`** (—Å—Ç—Ä–æ–∫–∏ 86-96): –õ–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏ markdown –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è. –ú–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
  ```python
  # –£–¥–∞–ª—è–µ–º ** –¥–ª—è –∂–∏—Ä–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
  answer = answer.replace("**", "")
  # –£–¥–∞–ª—è–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ * –¥–ª—è –∫—É—Ä—Å–∏–≤–∞
  answer = re.sub(r"\*([^\*]+)\*", r"\1", answer)
  ```
  **–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–æ—Å–∏–ª –ø—Ä–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É (`2*3*4`), –∑–≤–µ–∑–¥–æ—á–∫–∏ —É–¥–∞–ª—è—Ç—Å—è.

  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

  **–†–µ—à–µ–Ω–∏–µ**: –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –±–æ–ª–µ–µ —É–º–Ω—É—é –æ—á–∏—Å—Ç–∫—É –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é "–æ—á–∏—â–∞—Ç—å/–Ω–µ –æ—á–∏—â–∞—Ç—å markdown"

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–æ–±–∞–≤–∏—Ç—å rate limiting** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –°–µ–π—á–∞—Å –Ω–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å—á–µ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤**: `get_system_prompt()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ ‚Äî –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª + rotation**: –°–µ–π—á–∞—Å `bot.log` —Ä–∞—Å—Ç–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ. –î–æ–±–∞–≤–∏—Ç—å `RotatingFileHandler` –∏–∑ `logging.handlers`

---

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **66 —Ç–µ—Å—Ç–æ–≤, 100% pass** ‚Äî –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **Coverage 94%** (—Ü–µ–ª—å 80%) ‚Äî –æ—Ç–ª–∏—á–Ω–æ!
  - `config.py`: 100%
  - `constants.py`: 100%
  - `handlers/commands.py`: 90%
  - `handlers/messages.py`: 100%
  - `message_types.py`: 100%
  - `roles/prompts.py`: 100%
  - `services/context.py`: 96%
  - `services/llm.py`: 77%

- **TDD –ø–æ–¥—Ö–æ–¥**: –ò—Ç–µ—Ä–∞—Ü–∏—è 8 (–∫–æ–º–∞–Ω–¥–∞ `/role`) –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ RED ‚Üí GREEN ‚Üí REFACTOR

- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: `test_trim_context_parametrized` —Å 5 –∫–µ–π—Å–∞–º–∏

- **–ú–æ–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤**: OpenAI API –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–æ–∫–∏—Ä–æ–≤–∞–Ω

- **–§–∏–∫—Å—Ç—É—Ä—ã**: `clear_contexts`, `clear_llm_cache` —Å `autouse=True` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏

- **AAA pattern**: –í—Å–µ —Ç–µ—Å—Ç—ã —Å–ª–µ–¥—É—é—Ç Arrange-Act-Assert

- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: `test_handlers.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω—ã–π flow

#### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

- **Coverage `bot.py`: 0%**: –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

- **Coverage `services/llm.py`: 77%**: –ù–µ–ø–æ–∫—Ä—ã—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ 68-100 ‚Äî —ç—Ç–æ —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å markdown cleanup. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã:
  ```python
  async def test_llm_markdown_cleanup():
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–∏—Å—Ç–∫–∏ **bold**, *italic*, _underline_, `code`
      ...
  ```

  **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ error paths –ø–æ–∫—Ä—ã—Ç—ã –Ω–∞ 100%)

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ property-based testing**: –î–ª—è `trim_context()` –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å hypothesis —Ç–µ—Å—Ç—ã –¥–ª—è edge cases

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –î–æ–±–∞–≤–∏—Ç—å integration test –¥–ª—è `bot.py`:
   ```python
   async def test_bot_startup():
       """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
       # –ú–æ–∫–∏—Ä—É–µ–º load_config, Bot, Dispatcher
       # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   ```

2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è markdown cleanup –≤ `llm.py`

3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å `hypothesis` –¥–ª—è property-based testing –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (`trim_context`, `get_context`)

---

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **vision.md** ‚Äî –æ—Ç–ª–∏—á–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ:
  - –ß–µ—Ç–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã (KISS, YAGNI, MVP-first)
  - –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
  - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- **tasklist.md** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:
  - 8 –∏—Ç–µ—Ä–∞—Ü–∏–π, 29/29 –∑–∞–¥–∞—á (100%)
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
  - TDD –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ 8

- **tasklist_tech_debt.md** ‚Äî –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞:
  - 5 –∏—Ç–µ—Ä–∞—Ü–∏–π, 22/22 –∑–∞–¥–∞—á (100%)
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π
  - –°–µ–∫—Ü–∏—è "–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è" ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞!

- **README.md** ‚Äî comprehensive user guide:
  - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
  - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - –ö–æ–º–∞–Ω–¥—ã Makefile
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ UI –≤ Cursor/VS Code
  - –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞

- **ADRs** (Architecture Decision Records):
  - ADR-01: –í—ã–±–æ—Ä OpenAI
  - ADR-02: –í—ã–±–æ—Ä aiogram

- **–°–æ–≥–ª–∞—à–µ–Ω–∏—è –≤ `.cursor/rules/`**:
  - `conventions.mdc` (788 —Å—Ç—Ä–æ–∫)
  - `workflow.mdc` (398 —Å—Ç—Ä–æ–∫)
  - `workflow_tdd.mdc` (618 —Å—Ç—Ä–æ–∫)
  - `workflow_tech_debt.mdc` (464 —Å—Ç—Ä–æ–∫)
  - `qa_conventions.mdc` (503 —Å—Ç—Ä–æ–∫)

#### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: –•–æ—Ç—è –∫–æ–¥ –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `docs/api.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ deployment guide**: –í README –Ω–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ –¥–µ–ø–ª–æ—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä (systemd, Docker, –∏ —Ç.–¥.)

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –î–æ–±–∞–≤–∏—Ç—å `doc/deployment.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏:
   - –î–µ–ø–ª–æ–π –Ω–∞ VPS (systemd service)
   - Docker –æ–±—Ä–∞–∑ –∏ docker-compose
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

2. –î–æ–±–∞–≤–∏—Ç—å `CHANGELOG.md` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

3. –°–æ–∑–¥–∞—Ç—å ADR-03 –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è (in-memory) —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º trade-offs

---

### 5. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **–í—Å–µ 5 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã** (100%):
  - –ò—Ç–µ—Ä–∞—Ü–∏—è 0: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ ‚úÖ
  - –ò—Ç–µ—Ä–∞—Ü–∏—è 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ‚úÖ
  - –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è ‚úÖ
  - –ò—Ç–µ—Ä–∞—Ü–∏—è 3: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ ‚úÖ
  - –ò—Ç–µ—Ä–∞—Ü–∏—è 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ ‚úÖ

- **–ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥**:
  - –£–±—Ä–∞–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ config
  - –î–æ–±–∞–≤–ª–µ–Ω singleton –¥–ª—è OpenAI –∫–ª–∏–µ–Ω—Ç–∞
  - Enum –≤–º–µ—Å—Ç–æ magic strings
  - TypedDict –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö

- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π**: –í `tasklist_tech_debt.md` –µ—Å—Ç—å —Å–µ–∫—Ü–∏—è "–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è" ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞!

#### ‚ùå –¢–µ–∫—É—â–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

**–ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π**

1. **–•—Ä–∞–Ω–µ–Ω–∏–µ in-memory —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
   - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Redis, SQLite, JSON file)
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°—Ä–µ–¥–Ω–∏–π (–¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è MVP)

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Å–ø–∞–º–∏—Ç—å –±–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞–º–∏
   - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å middleware —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º N –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°—Ä–µ–¥–Ω–∏–π

3. **Markdown cleanup —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ –æ—Ç–≤–µ—Ç–∞
   - **–†–µ—à–µ–Ω–∏–µ**: –ë–æ–ª–µ–µ —É–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–∞—è –æ–ø—Ü–∏—è
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ù–∏–∑–∫–∏–π

4. **–õ–æ–≥–∏ —Ä–∞—Å—Ç—É—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: `bot.log` –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
   - **–†–µ—à–µ–Ω–∏–µ**: `RotatingFileHandler` —Å —Ä–æ—Ç–∞—Ü–∏–µ–π –ø–æ —Ä–∞–∑–º–µ—Ä—É
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ù–∏–∑–∫–∏–π

5. **–ù–µ—Ç graceful shutdown**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –±–æ—Ç–∞ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –æ–±–æ—Ä–≤–∞—Ç—å—Å—è
   - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É SIGTERM/SIGINT –∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ù–∏–∑–∫–∏–π

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –°–æ–∑–¥–∞—Ç—å `doc/tasklist_tech_debt_v2.md` –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ü–∏–∫–ª–∞ —É–ª—É—á—à–µ–Ω–∏–π
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ –º–∞—Ç—Ä–∏—Ü–µ Impact/Effort

---

### 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

#### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

- **Graceful error handling**: –í—Å–µ –æ—à–∏–±–∫–∏ API –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **Guard clauses**: –ü—Ä–æ–≤–µ—Ä–∫–∞ nullable –ø–æ–ª–µ–π –≤–µ–∑–¥–µ
- **–°–µ–∫—Ä–µ—Ç—ã –≤ `.env`**: –¢–æ–∫–µ–Ω—ã –Ω–µ –≤ –∫–æ–¥–µ, `.env` –≤ `.gitignore`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: `load_config()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–ù–µ—Ç SQL injection**: –ù–µ—Ç SQL, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è in-memory —Å–ª–æ–≤–∞—Ä—å
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ PII**: –ù–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–π

#### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting**: –ú–æ–∂–Ω–æ –∑–∞—Å–ø–∞–º–∏—Ç—å OpenAI API –∏ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –¥–µ–Ω—å–≥–∏

- **–ù–µ—Ç whitelist –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤—Å–µ–º. –î–ª—è production –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- **OpenAI API key –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –•—Ä–∞–Ω–∏—Ç—Å—è –≤ plain text –≤ `.env`. –î–ª—è production —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –º–µ–Ω–µ–¥–∂–µ—Ä (AWS Secrets Manager, HashiCorp Vault)

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ timeout –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤**: –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–µ—á–Ω–æ. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å TTL (Time To Live)

#### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–æ–±–∞–≤–∏—Ç—å whitelist –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
   ```python
   ALLOWED_USERS = [int(x) for x in getenv("ALLOWED_USERS", "").split(",")]

   @router.message()
   async def handle_message(message: Message):
       if message.from_user.id not in ALLOWED_USERS:
           await message.answer("‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ—Ç—É")
           return
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å rate limiting**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `aiogram` middleware –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `limits`

3. **TTL –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤**: –û—á–∏—â–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)

4. **Secrets manager –¥–ª—è production**: AWS Secrets Manager, Azure Key Vault, –∏–ª–∏ HashiCorp Vault

---

## –ú–µ—Ç—Ä–∏–∫–∏

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

| –ú–æ–¥—É–ª—å | Coverage | –¶–µ–ª–µ–≤–æ–π | –°—Ç–∞—Ç—É—Å |
|--------|----------|---------|--------|
| `config.py` | 100% | 70% | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `constants.py` | 100% | ‚Äî | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `message_types.py` | 100% | ‚Äî | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `handlers/commands.py` | 90% | 80% | ‚úÖ –•–æ—Ä–æ—à–æ |
| `handlers/messages.py` | 100% | 80% | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `roles/prompts.py` | 100% | ‚Äî | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `services/context.py` | 96% | 85% | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| `services/llm.py` | 77% | 85% | ‚ö†Ô∏è –ù–∏–∂–µ —Ü–µ–ª–∏ |
| `bot.py` | 0% | ‚Äî | ‚ÑπÔ∏è –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ |
| **–ò–¢–û–ì–û** | **94%** | **80%** | **‚úÖ –û—Ç–ª–∏—á–Ω–æ** |

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö—Ä–∏—Ç–∏—á–Ω—ã–µ | –í–∞–∂–Ω—ã–µ | –°—Ä–µ–¥–Ω–∏–µ | –ù–∏–∑–∫–∏–µ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ |
|-----------|-----------|--------|---------|--------|----------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 0 | 0 | 0 | 1 | 0 |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | 0 | 0 | 1 | 2 | 0 |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 0 | 0 | 0 | 3 | 0 |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 0 | 0 | 0 | 2 | 0 |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 0 | 0 | 2 | 2 | 0 |
| **–ò–¢–û–ì–û** | **0** | **0** | **3** | **10** | **0** |

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –†–µ–∑—É–ª—å—Ç–∞—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------------|-----------|------------|--------|
| `ruff format` | 0 –∏–∑–º–µ–Ω–µ–Ω–∏–π | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | ‚úÖ |
| `ruff check` | All checks passed! | 0 –æ—à–∏–±–æ–∫ | ‚úÖ |
| `mypy` | Success: no issues | 0 –æ—à–∏–±–æ–∫ | ‚úÖ |
| `pytest` | 66 passed | 100% pass | ‚úÖ |
| `coverage` | 94% | >= 80% | ‚úÖ |

---

## –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (P0)

**–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á.** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

### –£–ª—É—á—à–µ–Ω–∏—è (P1 ‚Äî –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

1. **Rate limiting –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - **–ì–¥–µ**: `handlers/messages.py`
   - **–ß—Ç–æ**: Middleware —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
   - **–û—Ü–µ–Ω–∫–∞**: 2 —á–∞—Å–∞

2. **Whitelist –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - **–ì–¥–µ**: `config.py`, `handlers/messages.py`
   - **–ß—Ç–æ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ `user_id` –≤ —Å–ø–∏—Å–∫–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö
   - **–û—Ü–µ–Ω–∫–∞**: 1 —á–∞—Å

3. **–£–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ markdown**
   - **–ì–¥–µ**: `services/llm.py`
   - **–ß—Ç–æ**: –ë–æ–ª–µ–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è regex –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
   - **–û—Ü–µ–Ω–∫–∞**: 2 —á–∞—Å–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã (P2 ‚Äî –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

4. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
   - **–ß—Ç–æ**: Redis –∏–ª–∏ SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
   - **–ó–∞—á–µ–º**: –ù–µ —Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ
   - **–û—Ü–µ–Ω–∫–∞**: 4-6 —á–∞—Å–æ–≤

5. **Deployment guide**
   - **–ß—Ç–æ**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é (systemd, Docker)
   - **–û—Ü–µ–Ω–∫–∞**: 2 —á–∞—Å–∞

6. **Graceful shutdown**
   - **–ß—Ç–æ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ SIGTERM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
   - **–û—Ü–µ–Ω–∫–∞**: 2 —á–∞—Å–∞

7. **Log rotation**
   - **–ß—Ç–æ**: `RotatingFileHandler` –¥–ª—è –ª–æ–≥–æ–≤
   - **–û—Ü–µ–Ω–∫–∞**: 30 –º–∏–Ω—É—Ç

8. **–¢–µ—Å—Ç—ã –¥–ª—è markdown cleanup**
   - **–ß—Ç–æ**: –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ —Å—Ç—Ä–æ–∫–∏ 68-100 –≤ `llm.py`
   - **–û—Ü–µ–Ω–∫–∞**: 1 —á–∞—Å

9. **Integration test –¥–ª—è bot.py**
   - **–ß—Ç–æ**: –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
   - **–û—Ü–µ–Ω–∫–∞**: 1 —á–∞—Å

10. **TTL –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤**
    - **–ß—Ç–æ**: –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ (>24—á)
    - **–û—Ü–µ–Ω–∫–∞**: 1 —á–∞—Å

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç **systtechbot** ‚Äî —ç—Ç–æ **–æ–±—Ä–∞–∑—Ü–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä MVP** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π, —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –≤—ã—Å–æ–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º –∫–æ–¥–∞ –∏ –æ—Ç–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π.

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. ‚úÖ –°—Ç—Ä–æ–≥–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º KISS, YAGNI, MVP-first
2. ‚úÖ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ (ruff, mypy, pytest-cov)
3. ‚úÖ –í—ã—Å–æ–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (94%) —Å TDD –ø–æ–¥—Ö–æ–¥–æ–º
4. ‚úÖ Comprehensive –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (vision, tasklists, ADRs, README)
5. ‚úÖ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞
6. ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ Python 3.11+ (TypedDict, Enum, dataclass)
7. ‚úÖ Graceful error handling –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
8. ‚úÖ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

1. ‚ö†Ô∏è Rate limiting –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–ª—è production)
2. ‚ö†Ô∏è –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—Å–µ–π—á–∞—Å in-memory)
3. ‚ö†Ô∏è Deployment documentation (systemd, Docker)
4. ‚ö†Ô∏è –£–ª—É—á—à–µ–Ω–∏–µ markdown cleanup –≤ LLM –æ—Ç–≤–µ—Ç–∞—Ö

### –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 9/10 | –û—Ç–ª–∏—á–Ω–∞—è —Ç—Ä–µ—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | 10/10 | 0 –æ—à–∏–±–æ–∫ ruff + mypy |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 9/10 | 94% coverage, TDD –ø–æ–¥—Ö–æ–¥ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 9/10 | Comprehensive, –∞–∫—Ç—É–∞–ª—å–Ω–∞—è |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 7/10 | –ù—É–∂–µ–Ω rate limit –∏ auth |
| **–ò–¢–û–ì–û** | **90/100** | **–û—Ç–ª–∏—á–Ω–æ** |

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –∫–∞—á–µ—Å—Ç–≤–µ MVP. –î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–£–ª—É—á—à–µ–Ω–∏—è" (P1).

