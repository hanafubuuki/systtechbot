# Workflow разработки systtechbot

**Для:** Code Assistant (Cursor AI, GitHub Copilot, и т.д.)  
**Документы:** [vision.md](vision.md) | [conventions.md](conventions.md) | [tasklist.md](tasklist.md)

---

## Основные правила

### 1. Строго по плану

- Выполняй задачи **только** из [tasklist.md](tasklist.md)
- Итерации **строго последовательно** (0 → 1 → 2 → ... → 7)
- Не пропускай задачи
- Не добавляй функции "на будущее"

### 2. Итерация = цикл

Каждая итерация проходит через:

```
Согласование → Реализация → Тестирование → Коммит → Переход
```

---

## Пошаговый процесс

### Шаг 1: Согласование

**Перед началом итерации:**

1. Прочитай задачи текущей итерации из [tasklist.md](tasklist.md)
2. Предложи решение с **отрезками кода**:
   ```
   Итерация N: [Название]
   
   Задача 1: [название]
   Файл: path/to/file.py
   Код:
   ```python
   # предложенный код
   ```
   
   Задача 2: ...
   ```
3. Объясни подход **кратко**
4. **Дождись подтверждения** от пользователя

**❌ НЕ пиши код без согласования!**

---

### Шаг 2: Реализация

**После получения ОК:**

1. Создай/измени файлы согласно плану
2. Следуй [conventions.md](conventions.md)
3. Проверь:
   - ✅ Код соответствует KISS
   - ✅ Нет дублирования из vision.md
   - ✅ Обработка ошибок везде
   - ✅ Type hints для публичных функций

---

### Шаг 3: Проверка

**После реализации:**

1. Покажи, что было сделано:
   ```
   ✅ Создан: path/to/file.py
   ✅ Изменен: path/to/other.py
   
   Готово к тестированию.
   ```
2. Напомни тест из tasklist.md
3. **Дождись подтверждения** от пользователя

**❌ НЕ переходи к следующей задаче без подтверждения!**

---

### Шаг 4: Обновление прогресса

**После подтверждения:**

1. Обнови [tasklist.md](tasklist.md):
   - Отметь выполненные задачи: `- [x]`
   - Обнови счетчики в таблице прогресса
   - Обнови статусы итераций
   - Обнови процент выполнения

2. Пример изменения:
   ```markdown
   | 0 | Инфраструктура | ✅ Завершено | 5/5 | make install работает | 2025-10-10 |
   
   **Прогресс:** 5/25 задач (20%)
   ```

---

### Шаг 5: Коммит

**После обновления tasklist:**

```bash
git add .
git commit -m "feat(iter-N): краткое описание"
git push origin main
```

**Формат коммита:**
- `feat(iter-0): setup project structure`
- `feat(iter-1): add hello world bot`
- `feat(iter-2): integrate OpenAI API`
- и т.д.

---

### Шаг 6: Переход к следующей итерации

**После успешного коммита:**

1. Спроси разрешение:
   ```
   Итерация N завершена ✅
   
   Следующая: Итерация N+1 - [Название]
   Задачи:
   - [ ] ...
   - [ ] ...
   
   Переходим к согласованию?
   ```

2. **Дождись ОК** от пользователя
3. Вернись к **Шагу 1**

---

## Частые ситуации

### Если тест не прошел

```
1. Сообщи о проблеме
2. Предложи исправление
3. Дождись согласия
4. Исправь код
5. Повтори тест
```

**❌ НЕ переходи к следующей задаче с непройденным тестом!**

---

### Если нужно что-то изменить

```
1. Покажи текущий код
2. Предложи изменение
3. Объясни почему
4. Дождись согласия
5. Примени изменение
```

**❌ НЕ меняй код без согласования!**

---

### Если нужна новая зависимость

```
1. Проверь [vision.md → Технологии](vision.md#1-технологии)
2. Если там нет - спроси у пользователя
3. Дождись разрешения
4. Добавь в pyproject.toml (dependencies)
5. Выполни: uv sync
```

**❌ НЕ добавляй зависимости без разрешения!**

---

## Формат коммуникации

### ✅ Хорошо

```
Итерация 0: Инфраструктура

Предлагаю создать:

1. pyproject.toml
[project]
name = "systtechbot"
version = "0.1.0"
requires-python = ">=3.11"
dependencies = [
    "aiogram>=3.0.0,<4.0.0",
    "openai>=1.0.0,<2.0.0",
    "python-dotenv>=1.0.0,<2.0.0",
]

2. .gitignore
.venv/
.env
bot.log
__pycache__/
uv.lock

3. Makefile
[код]

Подход:
- Минимальный набор зависимостей
- Стандартный .gitignore для Python
- Makefile для быстрого старта

Согласны?
```

### ❌ Плохо

```
Создал все файлы. Готово.
```

---

## Checklist перед коммитом

- [ ] Все задачи итерации выполнены
- [ ] Тест пройден
- [ ] tasklist.md обновлен
- [ ] Код следует conventions.md
- [ ] Получено подтверждение от пользователя

---

## Важно!

1. **Всегда дожидайся подтверждения** перед действиями
2. **Никогда не пропускай тесты**
3. **Обновляй tasklist.md** после каждой итерации
4. **Делай коммиты** после каждой итерации
5. **Следуй KISS** — не усложняй

---

**Версия:** 1.0  
**Дата:** 2025-10-10

