---
alwaysApply: false
---
# TDD Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ systtechbot

**–î–ª—è:** Code Assistant (Cursor AI, GitHub Copilot, –∏ —Ç.–¥.)
**–ü–æ–¥—Ö–æ–¥:** Test-Driven Development (TDD)
**–î–æ–∫—É–º–µ–Ω—Ç—ã:** [vision.md](../../doc/vision.md) | [conventions.mdc](conventions.mdc) | [qa_conventions.mdc](qa_conventions.mdc) | [tasklist.md](../../doc/tasklist.md)

**–°–º. —Ç–∞–∫–∂–µ:** [workflow.mdc](workflow.mdc) ‚Äî –æ–±—ã—á–Ω—ã–π workflow –±–µ–∑ TDD

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### 1. –°—Ç—Ä–æ–≥–æ –ø–æ –ø–ª–∞–Ω—É

- –í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞—á–∏ **—Ç–æ–ª—å–∫–æ** –∏–∑ [tasklist.md](../../doc/tasklist.md)
- –ò—Ç–µ—Ä–∞—Ü–∏–∏ **—Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ** (0 ‚Üí 1 ‚Üí 2 ‚Üí ... ‚Üí 7)
- –ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –∑–∞–¥–∞—á–∏
- –ù–µ –¥–æ–±–∞–≤–ª—è–π —Ñ—É–Ω–∫—Ü–∏–∏ "–Ω–∞ –±—É–¥—É—â–µ–µ"

### 2. TDD —Ü–∏–∫–ª –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏

```
üî¥ RED ‚Üí üü¢ GREEN ‚Üí üîµ REFACTOR
```

**–ü—Ä–∞–≤–∏–ª–æ:** –°–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç, –ø–æ—Ç–æ–º –∫–æ–¥. –ù–∏–∫–æ–≥–¥–∞ –Ω–∞–æ–±–æ—Ä–æ—Ç.

### 3. –ò—Ç–µ—Ä–∞—Ü–∏—è = —Ü–∏–∫–ª

–ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑:

```
–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ ‚Üí üî¥ RED ‚Üí üü¢ GREEN ‚Üí üîµ REFACTOR ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ ‚Üí –ö–æ–º–º–∏—Ç ‚Üí –ü–µ—Ä–µ—Ö–æ–¥
```

---

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### –®–∞–≥ 1: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ

**–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –∏—Ç–µ—Ä–∞—Ü–∏–∏:**

1. –ü—Ä–æ—á–∏—Ç–∞–π –∑–∞–¥–∞—á–∏ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏–∑ [tasklist.md](../../doc/tasklist.md)
2. –ü—Ä–µ–¥–ª–æ–∂–∏ **—Å–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç—ã, –ø–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é**:
   ```
   –ò—Ç–µ—Ä–∞—Ü–∏—è N: [–ù–∞–∑–≤–∞–Ω–∏–µ]

   –ó–∞–¥–∞—á–∞ 1: [–Ω–∞–∑–≤–∞–Ω–∏–µ]

   üî¥ –¢–ï–°–¢ (tests/test_xxx.py):
   ```python
   def test_feature_behavior():
       """–û–ø–∏—Å–∞–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è"""
       # Arrange
       ...
       # Act
       result = feature_function(...)
       # Assert
       assert result == expected
   ```

   üü¢ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (module/xxx.py):
   ```python
   def feature_function(...):
       """–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞"""
       ...
   ```

   –ó–∞–¥–∞—á–∞ 2: ...
   ```
3. –û–±—ä—è—Å–Ω–∏ –ø–æ–¥—Ö–æ–¥ **–∫—Ä–∞—Ç–∫–æ**
4. **–î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**‚ùå –ù–ï –ø–∏—à–∏ –Ω–∏ —Ç–µ—Å—Ç—ã, –Ω–∏ –∫–æ–¥ –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è!**

---

### –®–∞–≥ 2: üî¥ RED ‚Äî Failing Test

**–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –û–ö:**

1. **–°–æ–∑–¥–∞–π failing test:**
   - –ù–∞–ø–∏—à–∏ —Ç–µ—Å—Ç **–î–û** –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞
   - –¢–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å **–æ–¥–Ω–æ** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π AAA pattern (Arrange ‚Üí Act ‚Üí Assert)
   - –°–ª–µ–¥—É–π [qa_conventions.mdc](qa_conventions.mdc)

2. **–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç:**
   ```bash
   uv run pytest tests/test_xxx.py::test_name -v
   ```

3. **–ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   üî¥ RED: Test created and failing

   Test: test_feature_behavior
   Expected: ‚úÖ
   Actual: ‚ùå (as expected)
   Error: [–ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É]

   –¢–µ—Å—Ç –≥–æ—Ç–æ–≤. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏?
   ```

4. **–î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è**

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –¢–µ—Å—Ç –ø–∞–¥–∞–µ—Ç —Å –ø–æ–Ω—è—Ç–Ω–æ–π –æ—à–∏–±–∫–æ–π (–Ω–µ ImportError, –Ω–µ SyntaxError).

**‚ùå –ù–ï –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ GREEN –±–µ–∑ failing —Ç–µ—Å—Ç–∞!**

---

### –®–∞–≥ 3: üü¢ GREEN ‚Äî Minimal Implementation

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è RED:**

1. **–ù–∞–ø–∏—à–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞:**
   - –¢–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
   - –ù–∏–∫–∞–∫–∏—Ö "—É–º–Ω—ã—Ö" —Ä–µ—à–µ–Ω–∏–π
   - –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –°–ª–µ–¥—É–π [conventions.mdc](conventions.mdc)

2. **–ü—Ä–æ–≤–µ—Ä—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
   - ‚úÖ Type hints –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (Python 3.11+ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
   - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞)
   - ‚úÖ Guard clauses –¥–ª—è nullable
   - ‚úÖ –ù–µ—Ç magic strings (–∏—Å–ø–æ–ª—å–∑—É–π Enum)

3. **–ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç:**
   ```bash
   uv run pytest tests/test_xxx.py::test_name -v
   ```

4. **–ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   üü¢ GREEN: Test passing

   Test: test_feature_behavior
   Status: ‚úÖ PASSED

   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
   - –§–∞–π–ª: module/xxx.py
   - –§—É–Ω–∫—Ü–∏—è: feature_function()

   –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É?
   ```

5. **–î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è**

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç. –ö–æ–¥ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**‚ùå –ù–ï —É—Å–ª–æ–∂–Ω—è–π! –ü–∏—à–∏ –º–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞!**

---

### –®–∞–≥ 4: üîµ REFACTOR ‚Äî Improve Code

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è GREEN:**

1. **–£–ª—É—á—à–∏ –∫–æ–¥ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   - –£–±–µ—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (DRY)
   - –£–ø—Ä–æ—Å—Ç–∏ –ª–æ–≥–∏–∫—É (KISS)
   - –£–ª—É—á—à–∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
   - –î–æ–±–∞–≤—å docstrings
   - **–ù–ï** –º–µ–Ω—è–π –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—Ç–µ—Å—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –∑–µ–ª–µ–Ω—ã–º–∏!)

2. **–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç–µ—Å—Ç—ã –≤—Å—ë –µ—â–µ –∑–µ–ª–µ–Ω—ã–µ:**
   ```bash
   uv run pytest tests/test_xxx.py -v
   ```

3. **–ü–æ–∫–∞–∂–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   ```
   üîµ REFACTOR: Code improved

   –ò–∑–º–µ–Ω–µ–Ω–∏—è:
   - –ò–∑–≤–ª–µ—á–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è _helper()
   - –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ...
   - –î–æ–±–∞–≤–ª–µ–Ω—ã docstrings

   Tests: ‚úÖ all passing

   –ó–∞–¥–∞—á–∞ N –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
   ```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –ö–æ–¥ —á–∏—â–µ, —Ç–µ—Å—Ç—ã –∑–µ–ª–µ–Ω—ã–µ.

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ —É–ª—É—á—à–∞—Ç—å –Ω–µ—á–µ–≥–æ ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏ —ç—Ç–æ—Ç —à–∞–≥ (—Å–∫–∞–∂–∏: "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è").

---

### –®–∞–≥ 5: –°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ –∏–ª–∏ –∏—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**–ï—Å–ª–∏ –≤ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –µ—Å—Ç—å –µ—â–µ –∑–∞–¥–∞—á–∏:**

1. –í–µ—Ä–Ω–∏—Å—å –∫ **–®–∞–≥—É 2 (üî¥ RED)** –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏
2. –ü–æ–≤—Ç–æ—Ä–∏ —Ü–∏–∫–ª RED ‚Üí GREEN ‚Üí REFACTOR

**–ï—Å–ª–∏ –≤—Å–µ –∑–∞–¥–∞—á–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**

1. –ü–µ—Ä–µ—Ö–æ–¥–∏ –∫ **–®–∞–≥—É 6 (–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞)**

---

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á –∏—Ç–µ—Ä–∞—Ü–∏–∏:**

1. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   uv run ruff format .
   ```
   - –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –ø–æ–∫–∞–∂–∏ –∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

2. **–õ–∏–Ω—Ç–∏–Ω–≥:**
   ```bash
   uv run ruff check .
   ```
   - –í—Å–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
   - –ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "‚úÖ All checks passed!"

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:**
   ```bash
   uv run mypy bot.py handlers/ services/ roles/ config.py
   ```
   - mypy –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å 0 –æ—à–∏–±–æ–∫
   - –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ ‚Äî –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º

4. **–í—Å–µ —Ç–µ—Å—Ç—ã:**
   ```bash
   uv run pytest tests/ -v
   ```
   - –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–º–∏
   - –ù–∏–∫–∞–∫–∏—Ö –Ω–æ–≤—ã—Ö –ø–∞–¥–µ–Ω–∏–π

5. **Coverage:**
   ```bash
   uv run pytest --cov=. --cov-report=term-missing
   ```
   - –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ coverage >= 80% –¥–ª—è services/ –∏ handlers/
   - –ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**‚ùå –ù–ï –ø–µ—Ä–µ—Ö–æ–¥–∏ –¥–∞–ª—å—à–µ, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ—à–ª–∞!**

---

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:**

1. –ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   ```
   ‚úÖ –ò—Ç–µ—Ä–∞—Ü–∏—è N –∑–∞–≤–µ—Ä—à–µ–Ω–∞

   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (TDD –ø–æ–¥—Ö–æ–¥):
   üî¥ –¢–µ—Å—Ç—ã:
   - test_feature_1: ‚úÖ
   - test_feature_2: ‚úÖ
   - test_feature_3: ‚úÖ

   üü¢ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
   - module/file1.py: feature_1()
   - module/file2.py: feature_2()

   üîµ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:
   - –ò–∑–≤–ª–µ—á–µ–Ω—ã helper —Ñ—É–Ω–∫—Ü–∏–∏
   - –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
   - ruff format: OK
   - ruff check: All checks passed!
   - mypy: Success: no issues found
   - pytest: all passed
   - coverage: 85% (target: 80%+)

   –ì–æ—Ç–æ–≤–æ –∫ —Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.
   ```

2. –ù–∞–ø–æ–º–Ω–∏ —Ç–µ—Å—Ç –∏–∑ tasklist.md
3. **–î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**‚ùå –ù–ï –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è!**

---

### –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**

1. –û–±–Ω–æ–≤–∏ [tasklist.md](../../doc/tasklist.md):
   - –û—Ç–º–µ—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏: `- [x]`
   - –û–±–Ω–æ–≤–∏ —Å—á–µ—Ç—á–∏–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
   - –û–±–Ω–æ–≤–∏ —Å—Ç–∞—Ç—É—Å—ã –∏—Ç–µ—Ä–∞—Ü–∏–π
   - –û–±–Ω–æ–≤–∏ –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

2. –ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```markdown
   | 2 | OpenAI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 3/3 | TDD: –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ | 2025-10-11 |

   **–ü—Ä–æ–≥—Ä–µ—Å—Å:** 13/25 –∑–∞–¥–∞—á (52%)
   ```

---

### –®–∞–≥ 9: –ö–æ–º–º–∏—Ç

**–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è tasklist:**

```bash
git add .
git commit -m "feat(iter-N): –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ [TDD]"
git push origin main
```

**–§–æ—Ä–º–∞—Ç –∫–æ–º–º–∏—Ç–∞:**
- `feat(iter-1): add hello world bot [TDD]`
- `feat(iter-2): integrate OpenAI API [TDD]`
- `feat(iter-3): implement context management [TDD]`

**–ü—Ä–∏–Ω—Ü–∏–ø:** –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π `[TDD]` –≤ –∫–æ–º–º–∏—Ç–µ, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è TDD –ø–æ–¥—Ö–æ–¥.

---

### –®–∞–≥ 10: –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:**

1. –°–ø—Ä–æ—Å–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ:
   ```
   –ò—Ç–µ—Ä–∞—Ü–∏—è N –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚úÖ (TDD –ø–æ–¥—Ö–æ–¥)

   –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: ‚úÖ
   - –õ–∏–Ω—Ç–∏–Ω–≥: ‚úÖ All checks passed
   - –¢–∏–ø–∏–∑–∞—Ü–∏—è: ‚úÖ 0 mypy errors
   - –¢–µ—Å—Ç—ã: ‚úÖ all passed (RED ‚Üí GREEN ‚Üí REFACTOR)
   - Coverage: ‚úÖ 85% (target: 80%+)

   –°–ª–µ–¥—É—é—â–∞—è: –ò—Ç–µ—Ä–∞—Ü–∏—è N+1 - [–ù–∞–∑–≤–∞–Ω–∏–µ]
   –ó–∞–¥–∞—á–∏:
   - [ ] ...
   - [ ] ...

   –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é?
   ```

2. **–î–æ–∂–¥–∏—Å—å –û–ö** –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –í–µ—Ä–Ω–∏—Å—å –∫ **–®–∞–≥—É 1**

---

## TDD Cycle –¥–µ—Ç–∞–ª—å–Ω–æ

### üî¥ RED Phase Checklist

- [ ] –¢–µ—Å—Ç –Ω–∞–ø–∏—Å–∞–Ω **–î–û** –∫–æ–¥–∞
- [ ] –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç **–æ–¥–Ω–æ** –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AAA pattern
- [ ] –¢–µ—Å—Ç **–ø–∞–¥–∞–µ—Ç** (–Ω–µ ImportError!)
- [ ] –û—à–∏–±–∫–∞ –ø–æ–Ω—è—Ç–Ω–∞ –∏ –æ–∂–∏–¥–∞–µ–º–∞
- [ ] –ü–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- [ ] –ü–æ–ª—É—á–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### üü¢ GREEN Phase Checklist

- [ ] –ù–∞–ø–∏—Å–∞–Ω **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π** –∫–æ–¥
- [ ] –¢–µ—Å—Ç **–ø—Ä–æ—Ö–æ–¥–∏—Ç**
- [ ] Type hints –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- [ ] –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] –ù–µ—Ç magic strings
- [ ] –ü–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- [ ] –ü–æ–ª—É—á–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### üîµ REFACTOR Phase Checklist

- [ ] –ö–æ–¥ —É–ª—É—á—à–µ–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (DRY)
- [ ] –ö–æ–¥ –ø—Ä–æ—Å—Ç (KISS)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã docstrings
- [ ] –¢–µ—Å—Ç—ã **–≤—Å—ë –µ—â–µ –∑–µ–ª–µ–Ω—ã–µ**
- [ ] –ü–æ–≤–µ–¥–µ–Ω–∏–µ **–Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å**
- [ ] –ü–æ–∫–∞–∑–∞–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

## –ß–∞—Å—Ç—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ (TDD-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ)

### –ï—Å–ª–∏ —Ç–µ—Å—Ç —Å—Ä–∞–∑—É –ø—Ä–æ—Ö–æ–¥–∏—Ç (GREEN –≤–º–µ—Å—Ç–æ RED)

```
‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –¢–µ—Å—Ç –ø—Ä–æ—à–µ–ª –±–µ–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
1. –õ–∏–±–æ —Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
2. –õ–∏–±–æ —Ç–µ—Å—Ç —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π
3. –õ–∏–±–æ —Ç–µ—Å—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

–î–µ–π—Å—Ç–≤–∏—è:
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç–µ—Å—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
2. –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ –µ—Å—Ç—å ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ —Ç–µ—Å—Ç –∏–∑–±—ã—Ç–æ—á–µ–Ω
3. –ï—Å–ª–∏ —Ç–µ—Å—Ç —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π ‚Äî —É–¥–∞–ª–∏ –µ–≥–æ (–Ω–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –æ—á–µ–≤–∏–¥–Ω–æ–µ)
4. –ï—Å–ª–∏ —Ç–µ—Å—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ‚Äî –∏—Å–ø—Ä–∞–≤—å

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º?
```

### –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç

```
‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

–ü—Ä–∏—á–∏–Ω—ã:
1. –ó–∞–¥–∞—á–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è ‚Üí —Ä–∞–∑–±–µ–π –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏
2. –ù–µ—è—Å–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚Üí —É—Ç–æ—á–Ω–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ù—É–∂–Ω—ã –º–æ–∫–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π patch() –∏–∑ unittest.mock

–î–µ–π—Å—Ç–≤–∏—è:
1. –û–ø–∏—à–∏ –ø—Ä–æ–±–ª–µ–º—É
2. –ü—Ä–µ–¥–ª–æ–∂–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã
3. –î–æ–∂–¥–∏—Å—å –ø–æ–º–æ—â–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –ï—Å–ª–∏ —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

```
‚ùå CRITICAL: –¢–µ—Å—Ç —É–ø–∞–ª –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞!

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±—ã–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º

–î–µ–π—Å—Ç–≤–∏—è:
1. –û—Ç–º–µ–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ —Ç–µ—Å—Ç—ã –∑–µ–ª–µ–Ω—ã–µ
3. –ü–æ–ø—Ä–æ–±—É–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–Ω–æ–≤–∞, –Ω–æ –º–µ–Ω—å—à–∏–º–∏ —à–∞–≥–∞–º–∏
4. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –∑–∞–ø—É—Å–∫–∞–π —Ç–µ—Å—Ç—ã
```

---

## –ü—Ä–∏–º–µ—Ä—ã TDD —Ü–∏–∫–ª–∞

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è

**üî¥ RED:**
```python
# tests/test_context.py
def test_clear_context_removes_user_data():
    """–û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    # Arrange
    user_contexts[(123, 456)] = {"messages": ["test"]}

    # Act
    clear_context(123, 456)

    # Assert
    assert (123, 456) not in user_contexts
```

–ó–∞–ø—É—Å–∫: `uv run pytest tests/test_context.py::test_clear_context_removes_user_data -v`
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ùå ImportError: cannot import name 'clear_context'

**üü¢ GREEN:**
```python
# services/context.py
def clear_context(user_id: int, chat_id: int) -> None:
    """–û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_contexts.pop((user_id, chat_id), None)
```

–ó–∞–ø—É—Å–∫: `uv run pytest tests/test_context.py::test_clear_context_removes_user_data -v`
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ PASSED

**üîµ REFACTOR:**
```python
# –ö–æ–¥ —É–∂–µ –ø—Ä–æ—Å—Ç–æ–π, —É–ª—É—á—à–∞—Ç—å –Ω–µ—á–µ–≥–æ
# –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
```

### –ü—Ä–∏–º–µ—Ä 2: –° –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

**üî¥ RED:**
```python
# tests/test_llm.py
@pytest.mark.asyncio
async def test_llm_handles_rate_limit():
    """RateLimitError –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"""
    with patch("services.llm.AsyncOpenAI") as mock:
        mock.return_value.chat.completions.create = AsyncMock(
            side_effect=RateLimitError("Rate limit", response=..., body=None)
        )
        result = await get_llm_response([...], config)
        assert "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤" in result
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ùå AttributeError: 'str' object has no attribute 'return_value'

**üü¢ GREEN:**
```python
# services/llm.py
async def get_llm_response(messages: list, config: Config) -> str:
    try:
        client = AsyncOpenAI(...)
        response = await client.chat.completions.create(...)
        return response.choices[0].message.content
    except RateLimitError:
        return "‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ PASSED

**üîµ REFACTOR:**
```python
# –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
def _get_client(config: Config) -> AsyncOpenAI:
    return AsyncOpenAI(api_key=config.openai_api_key, ...)

async def get_llm_response(messages: list, config: Config) -> str:
    try:
        client = _get_client(config)
        response = await client.chat.completions.create(...)
        return response.choices[0].message.content
    except RateLimitError:
        return "‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ PASSED (–≤—Å—ë –µ—â–µ –∑–µ–ª–µ–Ω—ã–µ)

---

## Checklist –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º (TDD)

### TDD —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω–µ–Ω

- [ ] –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –ø—Ä–æ–π–¥–µ–Ω —Ü–∏–∫–ª üî¥ RED ‚Üí üü¢ GREEN ‚Üí üîµ REFACTOR
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã **–î–û** –∫–æ–¥–∞
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã **–ø—Ä–æ—Ö–æ–¥—è—Ç**

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- [ ] `uv run ruff format .` ‚Äî –∫–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] `uv run ruff check .` ‚Äî 0 –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- [ ] `uv run mypy bot.py handlers/ services/ roles/ config.py` ‚Äî 0 –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤
- [ ] `uv run pytest tests/ -v` ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª–µ–Ω—ã–µ
- [ ] `uv run pytest --cov=. --cov-report=term-missing` ‚Äî coverage >= 80%

### –ö–æ–¥ –∏ –ø—Ä–æ—Ü–µ—Å—Å

- [ ] –í—Å–µ –∑–∞–¥–∞—á–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –¢–µ—Å—Ç –∏–∑ tasklist.md –ø—Ä–æ–π–¥–µ–Ω
- [ ] tasklist.md –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –ö–æ–¥ —Å–ª–µ–¥—É–µ—Ç conventions.mdc –∏ qa_conventions.mdc
- [ ] –ü–æ–ª—É—á–µ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# Linux/Mac
uv run ruff format . && uv run ruff check . && uv run mypy bot.py handlers/ services/ roles/ config.py && uv run pytest tests/ -v

# Windows PowerShell
uv run ruff format .; if ($?) { uv run ruff check . }; if ($?) { uv run mypy bot.py handlers/ services/ roles/ config.py }; if ($?) { uv run pytest tests/ -v }

# –ß–µ—Ä–µ–∑ Makefile
make quality
```

---

## –í–∞–∂–Ω–æ! (TDD-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ)

1. **–í–°–ï–ì–î–ê —Ç–µ—Å—Ç –î–û –∫–æ–¥–∞** ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ TDD
2. **–¢–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ø–∞–¥–∞—Ç—å** ‚Äî –µ—Å–ª–∏ —Å—Ä–∞–∑—É –ø—Ä–æ—Ö–æ–¥–∏—Ç, —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫
3. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥** ‚Äî –ø–∏—à–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
4. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–µ–ª–µ–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö** ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –ø—Ä–∏ –∫—Ä–∞—Å–Ω—ã—Ö
5. **–ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏** ‚Äî –æ–¥–∏–Ω —Ç–µ—Å—Ç ‚Üí –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è ‚Üí —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
6. **–î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** ‚Äî –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã (RED, GREEN, REFACTOR)
7. **Coverage >= 80%** ‚Äî TDD –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –¥–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π coverage
8. **–°–ª–µ–¥—É–π qa_conventions.mdc** ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (TDD)

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å:

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å |
|---------|-----------|---------------|
| **TDD –ø–æ–¥—Ö–æ–¥** | RED ‚Üí GREEN ‚Üí REFACTOR | –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤ / –∫–æ–¥ —Ä–µ–≤—å—é |
| **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | ruff (line-length: 100) | `uv run ruff format --check .` |
| **–õ–∏–Ω—Ç–∏–Ω–≥** | 0 –æ—à–∏–±–æ–∫ | `uv run ruff check .` |
| **–¢–∏–ø–∏–∑–∞—Ü–∏—è** | mypy strict, 0 –æ—à–∏–±–æ–∫ | `uv run mypy bot.py handlers/ services/ roles/ config.py` |
| **–¢–µ—Å—Ç—ã** | 100% pass | `uv run pytest tests/ -v` |
| **Coverage** | >= 80% | `uv run pytest --cov=. --cov-report=term-missing` |
| **TDD Coverage** | –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è = —Ç–µ—Å—Ç | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä—É—á–Ω—É—é |

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ TDD –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** ‚Äî —Ç–µ—Å—Ç—ã –ø–∏—à—É—Ç—Å—è —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞
‚úÖ **–ü—Ä–æ—Å—Ç–æ–π –¥–∏–∑–∞–π–Ω** ‚Äî –ø–∏—à–µ—à—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –∫–æ–¥
‚úÖ **–ú–µ–Ω—å—à–µ –±–∞–≥–æ–≤** ‚Äî –æ—à–∏–±–∫–∏ –ª–æ–≤—è—Ç—Å—è —Å—Ä–∞–∑—É
‚úÖ **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ** ‚Äî —Ç–µ—Å—Ç—ã –∑–∞—â–∏—â–∞—é—Ç –æ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö** ‚Äî —Ç–µ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥
‚úÖ **–í—ã—Å–æ–∫–∏–π coverage** ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º >= 80%

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-11
**–ë–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞:** workflow.mdc v2.0, qa_conventions.mdc v1.0
**–ü–æ–¥—Ö–æ–¥:** Test-Driven Development (RED ‚Üí GREEN ‚Üí REFACTOR)
